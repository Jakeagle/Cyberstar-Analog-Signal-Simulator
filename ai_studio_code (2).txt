# üõ†Ô∏è STPE/RETROMATION COMPATIBILITY PATCH

1. **48kHz Integer Lock:** In `generateBMCWaveform`, force every bit to exactly 10 samples. Bit transitions for Logical 1 MUST occur at sample 5.
2. **RAE Framing:** Every 12-byte TDM frame must start with Byte 0 set to `0xFF`. 
3. **LSB Encoding:** Refactor `encodeBMC` to process bits 0 through 7 (LSB-first).
4. **Pilot Tone Export:** Create an `exportShow()` function that:
   - Prepends 1.0 seconds of constant 4800Hz tone (all 1s) to Track TD and BD.
   - Prepends 1.0 seconds of silence to Music L and R.
5. **16-bit 4-Channel Interleaving:**
   - Interleave buffers: `[MusicL, MusicR, TrackTD, TrackBD]`.
   - Convert all samples from Float32 to Int16 (multiply by 32767).
   - Write a RIFF WAV header with:
     - NumChannels: 4 (0x04)
     - SampleRate: 48000 (0xBB80)
     - BitsPerSample: 16 (0x10)
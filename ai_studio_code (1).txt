# ğŸ› ï¸ PATCH: ProgramBlue & STPE Compatibility

## 1. Bit Order Flip (LSB-First)
In `encodeBMC`, change the loop to: `for (let b = 0; b <= 7; b++)`. 
Ensure Bit 1 from the PDF bitmap corresponds to Bit 0 in the JS buffer.

## 2. Integer-Perfect Timing
In `generateBMCWaveform`, remove all `Math.round` and `sampleAccum` logic. 
At 48kHz, every bit must be exactly 10 samples.
- Bit Start: `i * 10`
- Bit Mid: `(i * 10) + 5`
- Bit End: `(i * 10) + 10`

## 3. Strict 12-Byte Framing
Modify `_scheduleFrame`:
- Do NOT prepend `0xFF 0x00` headers.
- Do NOT append `0xAA` footers.
- Encode the raw 12-byte `trackTD` and `trackBD` buffers as a continuous 96-bit loop.

## 4. Pilot Tone Implementation
Modify the `export` function:
- Prepend 1.0 seconds of "Logical 1" bits (4800Hz screech) to the start of the audio file. 
- This allows ProgramBlue to lock its clock before the show begins.

## 5. Raw Export (No Filter)
- Add a toggle: `isExporting`. 
- If `isExporting === true`, bypass `applyLowpassFilter`. Digital decoders need raw square waves.